# Windows API 模拟键鼠操作

## 移动鼠标位置

使用 `SetCursorPos` 可以移动鼠标位置：

```c
SetCursorPos(x, y);
```

在开启缩放的情况下，使用的是逻辑坐标，可以通过以下代码忽略缩放：

```c
SetProcessDpiAwarenessContext(DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2);
```

## 模拟鼠标点击

按下：

```c
INPUT input = {0};
input.type = INPUT_MOUSE;
input.mi.dwFlags = MOUSEEVENTF_LEFTDOWN;        // 鼠标左键按下
SendInput(1, &input, sizeof(INPUT));
```

抬起：

```c
INPUT input = {0};
input.type = INPUT_MOUSE;
input.mi.dwFlags = MOUSEEVENTF_LEFTUP;          // 鼠标左键抬起
SendInput(1, &input, sizeof(INPUT));
```

## 模拟键盘操作

按下：

```c
INPUT input = {0};
input.type = INPUT_KEYBOARD;
input.ki.wVk = key;                             // 虚拟按键码
SendInput(1, &input, sizeof(INPUT));
```

抬起：

```c
INPUT input = {0};
input.type = INPUT_KEYBOARD;
input.ki.wVk = key;                             // 虚拟按键码
input.ki.dwFlags = KEYEVENTF_KEYUP;             // 按键抬起
SendInput(1, &input, sizeof(INPUT));
```